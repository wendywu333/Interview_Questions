/**
 * 
 */
package LeetCode;

import java.util.HashMap;

/**
 * @author Wenzhe
 * @date 4/6/2013
 * 
 */
public class Longest_Consecutive_Sequence {

	public int longestConsecutive(int[] num) {

		if (num.length == 0) {
			return 0;
		}

		HashMap<Integer, Integer> start = new HashMap<Integer, Integer>();
		HashMap<Integer, Integer> end = new HashMap<Integer, Integer>();

		for (int a : num) {
			if (start.containsKey(a + 1) && end.containsKey(a - 1)) {

			} else if (start.containsKey(a + 1)) {

				start.put(a, start.get(a + 1) + 1);
				end.remove(a + start.get(a + 1));
				end.put(a + start.get(a + 1), start.get(a + 1) + 1);
				start.remove(a + 1);

			} else if (end.containsKey(a - 1)) {

				end.put(a, end.get(a - 1) + 1);
				start.remove(a - end.get(a - 1));
				start.put(a - end.get(a - 1), end.get(a - 1) + 1);
				end.remove(a - 1);

			} else {
				start.put(a, 1);
				end.put(a, 1);
			}
		}

		return 0;
	}

}
